<html>
<head>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script type="text/javascript" src="./user_data/AmazonPayments/js/jquery.blockUI.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            if ((navigator.userAgent.indexOf('iPhone') > 0 && navigator.userAgent.indexOf('iPad') == -1) || navigator.userAgent.indexOf('iPod') > 0 || navigator.userAgent.indexOf('Android') > 0) {
                // スマホ
                $.blockUI({
                    message: $('#disp_loading'),
                    css :{
                        'width': '80%',
                        'margin': 'auto',
                        'padding': '20px 10px',
                        'border': 'none',
                        'border-radius': '15px',
                        '-webkit-border-radius': '15px',
                        '-moz-border-radius': '15px',
                        'font-family': 'Gothic Medium BBB',
                        'left': '10%',
                        'box-sizing': 'border-box'
                    }
                });
            } else {
                // PC
                $.blockUI({
                    message: $('#disp_loading'),
                    css :{
                        'width': '500px',
                        'margin': '10px',
                        'padding': '10px',
                        'border': 'none',
                        'border-radius': '15px',
                        '-webkit-border-radius': '15px',
                        '-moz-border-radius': '15px',
                        'font-size': '80%',
                        'font-family': 'Gothic Medium BBB',
                        'left': 'calc((100% - 500px) / 2)',
                        'box-sizing': 'border-box'
                    }
                });
            }

            function getURLParameter(name, source) {
                return decodeURIComponent((new RegExp('[?|&|#]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(source)||[,""])[1].replace(/\+/g,'%20'))||null;
            }

            var url = 'amazon_redirect';
            var param = $(location).attr('hash').replace('#', '?');

            var state = param.substring(param.indexOf('state='));
            param = param.substring(0, param.indexOf('state')) + decodeURIComponent(state).replace('state=', '').replace(/,/g, '&');

            var userAgent = window.navigator.userAgent.toLowerCase();
            if (userAgent.indexOf('safari') != -1 && userAgent.indexOf('chrome') === -1) {
                setTimeout(function() {
                    window.location.href = url + param;
                }, 300);
            } else {
                window.location.href = url + param;
            }
        });
    </script>
</head>
<body>
    <div id="disp_loading" style="display:none;">
        <p>しばらくお待ち下さい。</p></br>
        <img src="./user_data/AmazonPayments/img/gif-load.gif" width="40px"/></br>
    </div>
</body>
</html>
